version: "0.29.0"

definitions:
  selector:
    type: RecordSelector
    extractor:
      type: DpathExtractor
      field_path: []
  requester:
    type: HttpRequester
    url_base: "https://example.com"
    http_method: "GET"
    authenticator:
      type: BearerAuthenticator
      api_token: "{{ config['api_key'] }}"
  retriever:
    type: SimpleRetriever
    record_selector:
      $ref: "#/definitions/selector"
    paginator:
      type: NoPagination
    requester:
      $ref: "#/definitions/requester"
  base_stream:
    type: DeclarativeStream
    retriever:
      $ref: "#/definitions/retriever"
  customers_stream:
    $ref: "#/definitions/base_stream"
    name: "customers"
    primary_key: "id"
    $parameters:
      path: "/example"

streams:
  - "#/definitions/customers_stream"

check:
  type: CheckStream
  stream_names:
    - "customers"

spec:
  type: Spec
  documentation_url: https://docs.airbyte.com/integrations/sources/xero
    connection_specification:
    $schema: http://json-schema.org/draft-07/schema#
    title: Xero Spec
    type: object
    required:
      - authentication
      - tenant_id
      - start_date
    additionalProperties: true

    properties:
    authentication:
      type: object
      title: Authenticate via Xero (OAuth)
      required:
        - client_id
        - client_secret
        - refresh_token
        - access_token
        - token_expiry_date
      properties:
        client_id:
          type: string
          title: Client ID
          description: "Enter your Xero application's Client ID"
        client_secret:
          type: string
          title: Client Secret
          description: "Enter your Xero application's Client Secret"
          airbyte_secret: true
        refresh_token:
          type: string
          title: Refresh Token
          description: "Enter your Xero application's refresh token"
          airbyte_secret: true
        access_token:
          type: string
          title: Access Token
          description: "Enter your Xero application's access token"
          airbyte_secret: true
        token_expiry_date:
          type: string
          description: "The date-time when the access token should be refreshed"
      order: 0
    tenant_id:
      title: Tenant ID
      type: string
      description: "Enter your Xero organization's Tenant ID"
      airbyte_secret: true
      order: 1
    start_date:
      type: string
      title: "Start Date"
      pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$"
      description: "UTC date and time in the format YYYY-MM-DDTHH:mm:ssZ. Any data with created_at before this data will not be synced."
      examples:
        - "2022-03-01T00:00:00Z"
      format: "date-time"
      order: 2

advanced_auth:
  auth_flow_type: oauth2.0
  oauth_config_specification:
    complete_oauth_output_specification:
      type: object
      additionalProperties: false
      properties:
        refresh_token:
          type: string
          path_in_connector_config:
            - authentication
            - refresh_token
        access_token:
          type: string
          path_in_connector_config:
            - authentication
            - access_token
        token_expiry_date:
          type: string
          path_in_connector_config:
            - authentication
            - token_expiry_date
          format: date-time
    complete_oauth_server_input_specification:
      type: object
      additionalProperties: false
      properties:
        client_id:
          type: string
        client_secret:
          type: string
    complete_oauth_server_output_specification:
      type: object
      additionalProperties: false
      properties:
        client_id:
          type: string
          path_in_connector_config:
            - authentication
            - client_id
        client_secret:
          type: string
          path_in_connector_config:
            - authentication
            - client_secret